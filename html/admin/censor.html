<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="stylesheet" href="../../resource/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../resource/font-awesome-4.7.0/css/font-awesome.min.css">
    <title>注册审核</title>

</head>
<!-- 还有各个选卡之间的切换效果未完成 -->
<!-- 还想做一个徽章，需要的话可能要改下fetch的php,而且还可以和提示框互动 -->

<body style="background-image: url(../../image/papper.png)">
    <div id="main" class="container">
        <!-- navigation_bar -->
        <nav class="navbar navbar-expand-md bg-dark navbar-dark shadow p-3 mb-3 mt-3 rounded sticky-top">
            <a class="navbar-brand" href="#">CrowdSourcing</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="collapsibleNavbar">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="fa fa-check-square-o">&nbsp;</i>注册审核</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="false"><i class="fa fa-id-card-o">&nbsp;</i>
                            人员管理
                        </a>
                        <div class="dropdown-menu shadow" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="publisherManage.html"><i class="fa fa-send">&nbsp;</i>发包人员管理</a>
                            <a class="dropdown-item" href="receiverManage.html"><i class="fa fa-coffee">&nbsp;</i>接包人员管理</a>
                        </div>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="company.html"><i class="fa fa-building-o">&nbsp;</i>公司管理</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="index.html"><i class="fa fa-user-circle">&nbsp;</i>个人信息</a>
                    </li>
                </ul>
                <!-- <form class="form-inline my-2 my-lg-8">
                    <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                    <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
                </form> -->
            </div>
            <div class="float-right">
                <!-- <a class="text-muted" href="#">[注销账号]</a> -->
                <img src="http://static.runoob.com/images/mix/img_avatar.png" class="rounded-circle" alt="Cinque Terre"
                    style="width:40px; height:40px;"><span>&nbsp;</span>
                <button type="button" class="btn btn-sm btn-outline-secondary" style="border: 0;"><i class="fa fa-power-off">&nbsp;</i>注销</button>

            </div>
        </nav>
        <h3><strong>注册审核表</strong></h3>
        <!-- content -->
        <div class="container-fluid shadow bg-light" style="padding: 0px; margin: 0px;">
            <!-- card -->
            <div class="card bg-muted" style="height: 600px ;">
                <div class="card-header">
                    <button class="btn btn-danger btn-sm flex-fill" @click='refuse(person.id)'><i class="fa fa-user-times">&nbsp;</i>拒绝</button>
                    <button class="btn btn-success btn-sm flex-fill" @click='verified(person.id)'><i class="fa fa-user-plus">&nbsp;</i>通过</button>
                </div>
                <div class="card-body" style="padding: 0px; margin: 0px;">
                    <!-- different views in unique size window -->
                    <div class="table-responsive">

                        <div class="text-center">
                            <!-- dark table + hover effect + grey hover + set border + small table -->
                            <table class="table  table-hover table-striped table-sm ">
                                <div>
                                    <thead>
                                        <tr>
                                            <th><input type="checkbox" class="form-check-input" value="">全选</th>
                                            <th>姓名</th>
                                            <th>手机</th>
                                            <th>邮箱</th>
                                            <th>隶属公司</th>
                                        </tr>
                                    </thead>
                                </div>
                                <!-- 有新的待审核人员时增加到表格下 -->
                                <div>
                                    <tr v-for="person in info">
                                        <td><input type="checkbox" class="form-check-input" value=""></td>
                                        <td>{{person.name}}</td>
                                        <td>{{person.phone}}</td>
                                        <td>{{person.mail}}</td>
                                        <td>{{person.companyName}}</td>
                                        <!-- <td> -->
                                            <!-- small button with the click event reload the page  -->

                                            <!-- 不行就先改回来，之前这两个还是可以用的 -->
                                            <!-- <input type="button" value="通过" @click='verified(person.id)'> -->
                                            <!-- <input type="button" value="拒绝" @click='refuse(person.id)'> -->
                                        <!-- </td> -->
                                    </tr>
                                </div>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>



    </div>
</body>
<script src="../../resource/vue/vue.js"></script>
<script src="../../resource/jquery/jquery.js"></script>
<script src="../../resource/bootstrap/js/bootstrap.min.js"></script>
<script>
    // 创建一个新的 Vue 实例
    var main = new Vue({
        // DOM 元素，挂载视图模型
        el: '#main',
        // 定义属性，并设置初始值
        data: {
            info: [],
            badgeIndex: '',
        },


        created() {
            var that = this;
            $.post("../../php/admin/fetchUncensored.php", {}).done((data) => {
                data = JSON.parse(data);
                that.info = data;
                // data.forEach(user => {
                //     that.info.push(user);
                // });
            })

        },

        // 点击菜单使用的函数
        methods: {
            //审核是否通过
            verified: function (id) {
                var that = this;
                $.post("../../php/admin/verify.php", {
                    personId: id,
                    hasPass: true,
                }).done((data) => {
                    data = JSON.parse(data);
                    data.forEach(user => {
                        that.info.push(user);
                    });
                })
            },
            refuse: function (id) {
                var that = this;
                $.post("../../php/admin/verify.php", {
                    personId: id,
                    hasPass: false,
                }).done((data) => {
                    data = JSON.parse(data);
                    data.forEach(user => {
                        that.info.push(user);
                    });
                })
            },
        }
    })
</script>

</html>