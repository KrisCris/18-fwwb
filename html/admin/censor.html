<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>注册审核</title>

</head>

<body>
  <div id="main">
    <div>
      <!-- 头像 -->
      <img>
    <a href="#">注册审核</a>
    <a href="manage.html">人员管理</a>
    <a href="company.html">外包公司</a>
    <a href="info.html">人员信息</a>
    </div>
    <div>
      <!-- //注册审核页面 -->
      <div>
        <h4>注册审核列表</h4>
        <table border="1">
          <div>
            <tr>
              <th>用户名</th>
              <th>姓名</th>
              <th>手机</th>
              <th>邮箱</th>
              <th>隶属公司</th>
              <th>审核</th>
            </tr>
          </div>
          <!-- 有新的待审核人员时增加到表格下 -->
          <div>

            <tr v-for="(person,index) in info" id="index">
              <td>{{person.usename}}</td>
              <td>{{person.name}}</td>
              <td>{{person.phone}}</td>
              <td>{{person.mail}}</td>
              <td>{{person.company}}</td>
              <td>
                <input type="button" value="通过" @click='console.log(person[index]);'>
                <input type="button" value="拒绝" @click='refuse'>
              </td>
            </tr>

          </div>

        </table>
      </div>
    </div>
  </div>


</body>
<script src="../../resource/vue/vue.js"></script>
<script src="../../resource/jquery/jquery.js"></script>
<script>
  // 创建一个新的 Vue 实例
  var main = new Vue({
    // DOM 元素，挂载视图模型
    el: '#main',
    // 定义属性，并设置初始值
    data: {
      info: [],
    },
    //开始时运行
    created() {
      var that = this;
      $.post("../../php/admin/fetchUncensored.php", {}).done((data) => {
        data = JSON.parse(data);

        data.forEach(user => {
          that.info.push(user);
        });
      })

    },
    // 点击菜单使用的函数
    methods: {
      //审核通过
      verified: function () {
        var that = this;
        $.post("../../php/admin/verify.php", {
          info: that.info,
        }).done((data) => {
          /////
          data = JSON.parse(data);

          data.forEach(user => {
            that.info.push(user);
          });

        })
      },
      //拒绝通过
      refuse: function () {
        var that = this;
        $.post("../../php/admin/refuse.php", {
          info: that.info,
        }).done((data) => {
          /////
          data = JSON.parse(data);

          data.forEach(user => {
            that.info.push(user);
          });

        })
      },

    }
  })
</script>

</html>